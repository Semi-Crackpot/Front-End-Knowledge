# 用户权限管理

### 给数据库设置用户权限
1.  切换到数据库：``use admin``
2.  给当前数据库创建超级管理员
    ```js
    db.createUser({
        // 用户名
        user:'admin',
        // 密码
        pwd:'123456',
        // 注意，角色root只能在admin数据库中使用
        roles:[{role:'root',db:'admin'}]
    })
3.  修改配置文件``D:\SoftwareTools\MongoDB\bin\mongod.cfg``
    ```js
    // 将security前的注释符号#去掉
    security:
      // 注意，此处必须采用 2个空格 作为缩进，否则无法重启服务
      authorization: enabled
4.  在CMD输入``service.msc``，重启服务``MongoDB Server``
5.  连接本地数据库时，不再使用mongo
    - 改用命令``mongo admin -u admin -p 123456``，第一个admin是创建管理员的数据库，第二个admin是用户名，123456是密码

### 数据库角色
1.  超级管理员：``root``
2.  数据库管理角色：dbAdmin、``dbOwner``、userAdmin
3.  备份恢复角色：backup、restore
4.  数据库用户角色：read、readWrite
5.  集群管理角色：clusterAdmin、clusterManager、clusterMonitor
6.  所有数据库角色：readAnyDatabase、readWriteAnyDatabase

### 管理员操作
1.  删除管理员：``db.dropUser('admin')``
2.  查看管理员：``show users`` 
3.  修改管理员密码：``db.updateUser('admin', {pwd:'000404'})``，admin是管理员的用户名
4.  密码认证：``db.auth('admin', '123456')``
    - 首先通过``mongo admin``连接数据库，此时不用加上用户名和密码
    - 再通过密码认证，即可以操作数据库

### root用户与普通用户的区别
1.  使用root用户登录，可以操作所有数据库
2.  使用普通用户登录，只能操作用户管理的数据库

### 在Nodejs连接数据库
1.  未设置管理员时，获取数据库：``const url = 'mongodb://127.0.0.1:27017/'``
2.  设置管理员时，获取数据库：``const url = 'mongodb://admin:123456@127.0.0.1:27017/'``，admin是用户名，123456是密码

### 